<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quotation ‚Äì Abbas & Sons Roll Tech</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Barlow:wght@300;400;500;600&family=Barlow+Condensed:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --iron:#1a1a1a;--rust:#b84a1e;--steel:#3d5a6e;
  --silver:#c0c8d0;--warm:#f5f2ee;--amber:#d4802a;--lgray:#e8e4df;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Barlow',sans-serif;background:#c8c4bc;color:var(--iron);min-height:100vh;padding:14px;}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETTINGS PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#settings-panel{max-width:1080px;margin:0 auto 16px;border-radius:5px;overflow:hidden;box-shadow:0 4px 22px rgba(0,0,0,.45);}
.s-topbar{background:#000;padding:11px 20px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;user-select:none;}
.s-topbar h2{font-family:'Bebas Neue',sans-serif;letter-spacing:4px;font-size:1rem;color:var(--amber);}
.s-badge{background:#1a1a1a;border:1px solid #3a3a3a;border-radius:3px;padding:3px 9px;font-size:.6rem;letter-spacing:2px;color:#555;text-transform:uppercase;}
.s-arr{color:var(--amber);font-size:.85rem;transition:transform .3s;}
.s-arr.closed{transform:rotate(180deg);}

.s-body{background:#111;padding:18px 20px 22px;display:grid;grid-template-columns:repeat(auto-fill,minmax(195px,1fr));gap:13px;}
.s-body.hide{display:none;}

.sg{background:#1c1c1c;border:1px solid #2a2a2a;border-radius:3px;padding:12px;}
.sg-title{font-family:'Barlow Condensed',sans-serif;font-size:.62rem;letter-spacing:3px;text-transform:uppercase;color:var(--amber);margin-bottom:9px;border-bottom:1px solid #2a2a2a;padding-bottom:5px;}
.sf{display:flex;flex-direction:column;gap:3px;margin-bottom:8px;}
.sf:last-child{margin-bottom:0;}
.sf label{font-size:.58rem;letter-spacing:2px;text-transform:uppercase;color:var(--silver);}
.sf input,.sf textarea,.sf select{background:#232323;border:1px solid #363636;border-radius:2px;color:#ddd;font-family:'Barlow',sans-serif;font-size:.81rem;padding:5px 8px;outline:none;width:100%;}
.sf textarea{resize:vertical;min-height:62px;line-height:1.5;}
.sf input:focus,.sf textarea:focus{border-color:var(--rust);}

.logo-btn{background:var(--rust);color:#fff;border:none;padding:6px 0;font-family:'Barlow Condensed',sans-serif;font-size:.76rem;letter-spacing:2px;text-transform:uppercase;cursor:pointer;border-radius:2px;width:100%;margin-top:3px;}
.logo-btn:hover{background:#9e3614;}
.logo-btn.remove{background:#2a2a2a;color:#777;}
.logo-btn.remove:hover{background:#333;color:#aaa;}

.s-wide{grid-column:1/-1;}
.action-bar{grid-column:1/-1;display:flex;gap:9px;flex-wrap:wrap;padding-top:4px;}
.btn{padding:9px 20px;font-family:'Barlow Condensed',sans-serif;font-size:.86rem;letter-spacing:2px;text-transform:uppercase;border:none;cursor:pointer;border-radius:2px;font-weight:600;}
.btn-pdf{background:var(--rust);color:#fff;} .btn-pdf:hover{background:#9e3614;}
.btn-print{background:var(--steel);color:#fff;} .btn-print:hover{background:#2c3f50;}
.btn-reset{background:#2a2a2a;color:#777;} .btn-reset:hover{background:#333;color:#aaa;}

/* Column manager */
.col-manager{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.col-toggle{display:flex;align-items:center;justify-content:space-between;background:#232323;border:1px solid #333;border-radius:3px;padding:6px 9px;}
.col-toggle span{font-size:.68rem;letter-spacing:1px;text-transform:uppercase;color:#bbb;}
.tog-switch{position:relative;width:32px;height:17px;flex-shrink:0;}
.tog-switch input{opacity:0;width:0;height:0;}
.tog-slider{position:absolute;inset:0;background:#333;border-radius:17px;cursor:pointer;transition:.25s;}
.tog-slider:before{content:'';position:absolute;width:11px;height:11px;left:3px;top:3px;background:#666;border-radius:50%;transition:.25s;}
.tog-switch input:checked+.tog-slider{background:var(--steel);}
.tog-switch input:checked+.tog-slider:before{transform:translateX(15px);background:#fff;}

/* Width controls */
.width-controls{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.wc-field{display:flex;flex-direction:column;gap:2px;}
.wc-field label{font-size:.56rem;letter-spacing:1.5px;text-transform:uppercase;color:#888;}
.wc-field input{background:#232323;border:1px solid #363636;border-radius:2px;color:#ddd;font-family:'Barlow',sans-serif;font-size:.78rem;padding:4px 7px;outline:none;width:100%;}
.wc-field input:focus{border-color:var(--rust);}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DOCUMENT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#quote-doc{background:var(--warm);max-width:1080px;margin:0 auto;box-shadow:0 6px 36px rgba(0,0,0,.28);overflow:hidden;}
.doc-topbar{background:var(--iron);height:7px;}

.doc-header{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:18px;padding:24px 32px 18px;border-bottom:3px solid var(--rust);position:relative;}
.doc-header::after{content:'';position:absolute;bottom:-6px;left:0;right:0;height:1px;background:var(--amber);}
#logo-display{width:80px;height:80px;object-fit:contain;display:none;}
#logo-ph{width:80px;height:80px;background:var(--iron);display:flex;align-items:center;justify-content:center;}
#logo-ph svg{opacity:.4;}
#disp-company{font-family:'Bebas Neue',sans-serif;font-size:2rem;letter-spacing:4px;line-height:1;}
#disp-tagline{font-family:'Barlow Condensed',sans-serif;font-size:.78rem;letter-spacing:2.5px;text-transform:uppercase;color:var(--rust);margin-top:3px;}
#disp-addr{font-size:.72rem;color:#666;margin-top:6px;line-height:1.6;}
.qtitle-block{text-align:right;}
.qtitle-block h1{font-family:'Bebas Neue',sans-serif;font-size:2.6rem;letter-spacing:6px;color:var(--steel);line-height:1;}
.qref-label{font-size:.63rem;letter-spacing:2px;text-transform:uppercase;color:#999;margin-top:4px;}
.qref-input{text-align:right;border:none;border-bottom:2px solid var(--rust);font-family:'Barlow Condensed',sans-serif;font-size:1.05rem;font-weight:700;color:var(--rust);outline:none;background:transparent;width:150px;}

.doc-meta{background:var(--steel);display:grid;grid-template-columns:repeat(4,1fr);}
.mc{padding:9px 16px;border-right:1px solid rgba(255,255,255,.1);}
.mc:last-child{border-right:none;}
.mc label{display:block;font-size:.58rem;letter-spacing:2px;text-transform:uppercase;color:var(--silver);margin-bottom:2px;}
.mc input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.22);color:#fff;font-family:'Barlow',sans-serif;font-size:.84rem;width:100%;outline:none;padding:2px 0;}
.mc input::placeholder{color:rgba(255,255,255,.26);}

.doc-body{padding:24px 32px;}

.customer-row{display:grid;grid-template-columns:1fr auto;align-items:end;gap:18px;background:#ede9e3;border-left:4px solid var(--rust);padding:12px 15px;margin-bottom:20px;}
.cr-left label,.cr-right label{display:block;font-family:'Bebas Neue',sans-serif;font-size:.76rem;letter-spacing:3px;color:var(--rust);margin-bottom:4px;}
.cr-right label{color:var(--steel);}
.cr-left input{width:100%;background:transparent;border:none;border-bottom:1px solid #bbb;font-family:'Barlow',sans-serif;font-size:.93rem;color:var(--iron);outline:none;padding:3px 0;}
.cr-left input::placeholder{color:#bbb;}
.cr-right input{width:145px;background:transparent;border:none;border-bottom:2px solid var(--rust);font-family:'Barlow Condensed',sans-serif;font-weight:700;color:var(--rust);font-size:1rem;outline:none;text-align:right;padding:3px 0;}

.stitle{font-family:'Bebas Neue',sans-serif;font-size:.92rem;letter-spacing:4px;color:var(--iron);border-bottom:2px solid var(--rust);padding-bottom:5px;margin-bottom:11px;display:flex;align-items:center;gap:9px;}
.stitle .line{flex:1;height:1px;background:var(--lgray);}

/* ‚îÄ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ‚îÄ */
.tbl-wrap{overflow-x:auto;}
table.itable{width:100%;border-collapse:collapse;font-size:.76rem;table-layout:auto;}
table.itable thead tr.th-main{background:var(--iron);color:var(--warm);}
table.itable thead tr.th-sub{background:#273d4d;}
table.itable th{padding:8px 6px;text-align:left;font-family:'Barlow Condensed',sans-serif;font-size:.65rem;letter-spacing:1.5px;text-transform:uppercase;font-weight:600;white-space:nowrap;}
table.itable th.ctr{text-align:center;}
table.itable th.rgt{text-align:right;}
.th-sub th{color:#8aabb8;font-size:.6rem;letter-spacing:1px;font-weight:400;padding:4px 6px;border-right:1px solid rgba(255,255,255,.06);}
.th-sub th:last-child{border-right:none;}

table.itable tbody tr{border-bottom:1px solid var(--lgray);}
table.itable tbody tr:nth-child(even){background:rgba(0,0,0,.015);}
table.itable tbody tr:hover{background:#ede9e3;}
table.itable td{padding:5px 6px;vertical-align:middle;}
table.itable td input,table.itable td select{border:none;background:transparent;font-family:'Barlow',sans-serif;font-size:.76rem;color:var(--iron);outline:none;padding:2px 0;width:100%;}
table.itable td input[type="number"]{text-align:right;}
table.itable .tc{text-align:right;font-weight:600;color:var(--rust);font-family:'Barlow Condensed',sans-serif;font-size:.85rem;white-space:nowrap;}
.del-btn{background:none;border:none;cursor:pointer;color:#ccc;font-size:.82rem;padding:0 2px;}
.del-btn:hover{color:var(--rust);}

/* Size cell ‚Äî compact with unit toggle */
.size-td{display:flex;align-items:center;gap:2px;}
.size-td input{flex:1;min-width:28px;text-align:center;font-size:.74rem;}
.unit-toggle{display:flex;border:1px solid #d0cbc5;border-radius:3px;overflow:hidden;flex-shrink:0;}
.unit-toggle button{padding:2px 4px;border:none;background:#ede9e3;color:#999;font-family:'Barlow Condensed',sans-serif;font-size:.55rem;letter-spacing:.3px;cursor:pointer;line-height:1.2;transition:background .15s,color .15s;}
.unit-toggle button.active{background:var(--steel);color:#fff;}
.unit-toggle button:first-child{border-right:1px solid #d0cbc5;}
.unit-label{font-size:.62rem;color:#999;font-family:'Barlow Condensed',sans-serif;flex-shrink:0;display:none;}

.add-btn{margin-top:8px;background:none;border:2px dashed var(--steel);color:var(--steel);font-family:'Barlow Condensed',sans-serif;font-size:.73rem;letter-spacing:2px;text-transform:uppercase;padding:6px 14px;cursor:pointer;border-radius:2px;transition:all .2s;}
.add-btn:hover{background:var(--steel);color:#fff;}

/* totals */
.totals-wrap{display:flex;justify-content:flex-end;margin-top:16px;}
.tbox{background:#ede9e3;border:1px solid var(--lgray);min-width:290px;}
.trow{display:flex;justify-content:space-between;align-items:center;padding:7px 14px;border-bottom:1px solid var(--lgray);font-size:.8rem;}
.trow label{color:#666;}
.trow .v{font-weight:600;font-family:'Barlow Condensed',sans-serif;}
.trow input[type="number"]{border:none;background:transparent;font-family:'Barlow',sans-serif;font-size:.8rem;font-weight:600;width:50px;text-align:right;outline:none;color:var(--iron);}
.trow.grand{background:var(--iron);color:#fff;padding:10px 14px;}
.trow.grand label{color:var(--silver);letter-spacing:2px;font-family:'Barlow Condensed',sans-serif;text-transform:uppercase;font-size:.65rem;}
.trow.grand .v{font-family:'Bebas Neue',sans-serif;font-size:1.35rem;color:var(--amber);letter-spacing:2px;}
.cur{margin-right:2px;color:#999;font-size:.75rem;}
.trow.grand .cur{color:#aaa;}

/* notes & terms */
.nt-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:20px;}
.nb h4{font-family:'Bebas Neue',sans-serif;letter-spacing:3px;font-size:.78rem;color:var(--steel);margin-bottom:5px;}
.nb textarea{width:100%;background:#ede9e3;border:1px solid var(--lgray);border-left:3px solid var(--steel);font-family:'Barlow',sans-serif;font-size:.76rem;color:var(--iron);padding:8px 10px;resize:vertical;outline:none;min-height:72px;line-height:1.6;}

/* signatures */
.sig-row{display:grid;grid-template-columns:1fr 1fr;gap:32px;margin-top:24px;padding-top:16px;border-top:1px solid var(--lgray);}
.sb label{display:block;font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:#aaa;margin-bottom:6px;}
.sl{border-bottom:1px solid var(--iron);height:34px;margin-bottom:4px;}
.sb p{font-size:.68rem;color:#bbb;}

/* footer */
.doc-foot{background:var(--iron);padding:12px 32px;display:flex;justify-content:space-between;align-items:center;}
#disp-foot-name{font-family:'Bebas Neue',sans-serif;letter-spacing:3px;color:var(--silver);font-size:.85rem;}
#disp-foot-contact{font-family:'Bebas Neue',sans-serif;letter-spacing:2px;color:var(--amber);font-size:1rem;}
.doc-botbar{background:var(--rust);height:5px;}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PRINT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
@media print{
  body{background:#fff;padding:0;}
  #settings-panel{display:none!important;}
  #quote-doc{box-shadow:none;max-width:100%;}
  .add-btn,.del-btn{display:none!important;}
  .unit-toggle{display:none!important;}
  .unit-label{display:inline!important;}
  input,select{border-color:transparent!important;background:transparent!important;}
  .mc input{border-bottom-color:rgba(255,255,255,.22)!important;}
  .nb textarea{border:none!important;padding:0!important;background:transparent!important;}
  @page{margin:0;size:A4;}
}
</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     ‚öô SETTINGS PANEL ‚Äî hidden in PDF
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="settings-panel">
  <div class="s-topbar" onclick="toggleSettings()">
    <h2>‚öô Settings &amp; Customization</h2>
    <span class="s-badge">üîí Hidden in PDF / Print</span>
    <span class="s-arr" id="sarr">‚ñ≤</span>
  </div>

  <div class="s-body" id="sbody">

    <!-- Logo -->
    <div class="sg">
      <div class="sg-title">Logo</div>
      <div class="sf">
        <label>Upload Logo</label>
        <button class="logo-btn" onclick="document.getElementById('logo-input').click()">üìé Upload Logo</button>
        <input type="file" id="logo-input" accept="image/*" style="display:none" onchange="uploadLogo(event)">
      </div>
      <div class="sf">
        <button class="logo-btn remove" onclick="removeLogo()">‚úï Remove Logo</button>
      </div>
    </div>

    <!-- Company -->
    <div class="sg">
      <div class="sg-title">Company</div>
      <div class="sf"><label>Company Name</label><input id="s-company" value="Abbas & Sons Roll Tech" oninput="sync('company')"></div>
      <div class="sf"><label>Tagline</label><input id="s-tagline" value="Specialized in Casting Steel Mill Rolls and Centrifugal Rolls" oninput="sync('tagline')"></div>
    </div>

    <!-- Address -->
    <div class="sg">
      <div class="sg-title">Address</div>
      <div class="sf">
        <label>Header Address</label>
        <textarea id="s-addr" oninput="sync('addr')">Karol Ghatti, Lahore</textarea>
      </div>
    </div>

    <!-- Footer -->
    <div class="sg">
      <div class="sg-title">Footer</div>
      <div class="sf"><label>Footer Name</label><input id="s-foot-name" value="Abbas & Sons Roll Tech" oninput="sync('foot-name')"></div>
      <div class="sf"><label>Footer Contact</label><input id="s-foot-contact" value="03009429705" oninput="sync('foot-contact')"></div>
    </div>

    <!-- Currency & Tax -->
    <div class="sg">
      <div class="sg-title">Currency &amp; Tax</div>
      <div class="sf"><label>Currency Symbol</label><input id="s-currency" value="PKR" oninput="updateCurrency()"></div>
      <div class="sf"><label>Default GST/Tax %</label><input type="number" id="s-default-tax" value="18" min="0" oninput="document.getElementById('tax').value=this.value;calcTotals()"></div>
      <div class="sf"><label>Default Discount %</label><input type="number" id="s-default-disc" value="0" min="0" oninput="document.getElementById('discount').value=this.value;calcTotals()"></div>
    </div>

    <!-- Column Visibility -->
    <div class="sg">
      <div class="sg-title">Show / Hide Columns</div>
      <div class="col-manager">
        <div class="col-toggle"><span>Dia</span><label class="tog-switch"><input type="checkbox" id="col-dia" checked onchange="toggleCol('dia')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Length</span><label class="tog-switch"><input type="checkbox" id="col-len" checked onchange="toggleCol('len')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Bore</span><label class="tog-switch"><input type="checkbox" id="col-bore" checked onchange="toggleCol('bore')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Weight</span><label class="tog-switch"><input type="checkbox" id="col-weight" checked onchange="toggleCol('weight')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Qty</span><label class="tog-switch"><input type="checkbox" id="col-qty" checked onchange="toggleCol('qty')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Unit</span><label class="tog-switch"><input type="checkbox" id="col-unit" onchange="toggleCol('unit')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Rate</span><label class="tog-switch"><input type="checkbox" id="col-rate" checked onchange="toggleCol('rate')"><span class="tog-slider"></span></label></div>
        <div class="col-toggle"><span>Amount</span><label class="tog-switch"><input type="checkbox" id="col-amount" checked onchange="toggleCol('amount')"><span class="tog-slider"></span></label></div>
      </div>
    </div>

    <!-- Column Widths -->
    <div class="sg">
      <div class="sg-title">Column Widths (px or auto)</div>
      <div class="width-controls">
        <div class="wc-field"><label>Description</label><input id="w-desc" value="auto" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Dia</label><input id="w-dia" value="auto" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Length</label><input id="w-len" value="auto" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Bore</label><input id="w-bore" value="auto" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Weight</label><input id="w-weight" value="60" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Qty</label><input id="w-qty" value="42" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Unit</label><input id="w-unit" value="48" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Rate</label><input id="w-rate" value="75" oninput="applyWidths()"></div>
        <div class="wc-field"><label>Amount</label><input id="w-amount" value="82" oninput="applyWidths()"></div>
      </div>
    </div>

    <!-- Notes & Terms (wide) -->
    <div class="sg s-wide">
      <div class="sg-title">Default Notes &amp; Terms &nbsp;<span style="color:#555;font-size:.58rem">(also editable directly in the document)</span></div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:13px;">
        <div class="sf">
          <label>Notes</label>
          <textarea id="s-notes" oninput="syncTA('notes')">All castings subject to standard inspection per agreed Sizes.
Pattern / tooling cost billed separately if applicable.</textarea>
        </div>
        <div class="sf">
          <label>Terms &amp; Conditions</label>
          <textarea id="s-terms" oninput="syncTA('terms')">Payment: 50% advance, 50% against delivery.
Validity: Prices valid for 30 days from issue date.</textarea>
        </div>
      </div>
    </div>

    <!-- Signature Labels -->
    <div class="sg">
      <div class="sg-title">Signature Labels</div>
      <div class="sf"><label>Signatory 1</label><input id="s-sig1" value="Authorized Signatory" oninput="document.getElementById('sig1-label').textContent=this.value"></div>
      <div class="sf"><label>Signatory 2</label><input id="s-sig2" value="Client Acceptance" oninput="document.getElementById('sig2-label').textContent=this.value"></div>
    </div>

    <!-- Actions -->
    <div class="action-bar">
      <button class="btn btn-pdf"   onclick="downloadPDF()">‚¨á Download PDF</button>
      <button class="btn btn-print" onclick="window.print()">üñ® Print / Save as PDF</button>
      <button class="btn btn-reset" onclick="resetForm()">‚Ü∫ Reset Form</button>
    </div>

  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     QUOTATION DOCUMENT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="quote-doc">
  <div class="doc-topbar"></div>

  <div class="doc-header">
    <div>
      <img id="logo-display" src="" alt="Logo">
      <div id="logo-ph">
        <svg width="56" height="56" viewBox="0 0 60 60" fill="none">
          <polygon points="30,4 56,18 56,42 30,56 4,42 4,18" stroke="#c0c8d0" stroke-width="2" fill="none"/>
          <polygon points="30,14 46,23 46,37 30,46 14,37 14,23" stroke="#b84a1e" stroke-width="1.5" fill="none"/>
          <circle cx="30" cy="30" r="5" fill="#c0c8d0"/>
        </svg>
      </div>
    </div>
    <div>
      <div id="disp-company">Abbas &amp; Sons Roll Tech</div>
      <div id="disp-tagline">Specialized in Casting Steel Mill Rolls and Centrifugal Rolls</div>
      <div id="disp-addr">Karol Ghatti, Lahore</div>
    </div>
    <div class="qtitle-block">
      <h1>QUOTATION</h1>
      <div class="qref-label">Quote Reference</div>
      <input class="qref-input" type="text" id="quote-ref" value="AST-2026-001">
    </div>
  </div>

  <div class="doc-meta">
    <div class="mc"><label>Issue Date</label><input type="date" id="meta-date"></div>
    <div class="mc"><label>Valid Until</label><input type="date" id="meta-valid"></div>
    <div class="mc"><label>Delivery Lead Time</label><input type="text" placeholder="e.g. 4‚Äì6 weeks after PO"></div>
    <div class="mc"><label>Payment Terms</label><input type="text" placeholder="50% Advance / 50% Delivery"></div>
  </div>

  <div class="doc-body">

    <div class="customer-row">
      <div class="cr-left">
        <label>Customer / Party Name</label>
        <input type="text" id="customer-name" placeholder="Enter customer or party name‚Ä¶">
      </div>
      <div class="cr-right">
        <label>Quote No.</label>
        <input type="text" value="AST-2026-001" oninput="document.getElementById('quote-ref').value=this.value">
      </div>
    </div>

    <div class="stitle">Items &amp; Specifications <span class="line"></span></div>
    <div class="tbl-wrap">
      <table class="itable" id="itable">
        <thead>
          <tr class="th-main" id="th-main-row">
            <th id="th-hash" style="width:28px">#</th>
            <th id="th-desc">Item / Description</th>
            <th id="th-size-grp" class="ctr" colspan="3">Size <span style="font-size:.55rem;opacity:.5;font-weight:400">(in / mm per field)</span></th>
            <th id="th-weight" class="rgt">Wt(kg)</th>
            <th id="th-qty" class="rgt">Qty</th>
            <th id="th-unit">Unit</th>
            <th id="th-rate" class="rgt">Rate/kg</th>
            <th id="th-amount" class="rgt">Amount</th>
            <th style="width:22px"></th>
          </tr>
          <tr class="th-sub" id="th-sub-row">
            <th></th>
            <th></th>
            <th id="th-dia" class="ctr">Dia</th>
            <th id="th-len" class="ctr">Length</th>
            <th id="th-bore" class="ctr">Bore</th>
            <th></th><th></th><th></th><th></th><th></th><th></th>
          </tr>
        </thead>
        <tbody id="items-body"></tbody>
      </table>
    </div>
    <button class="add-btn" onclick="addRow()">+ Add Item</button>

    <div class="totals-wrap">
      <div class="tbox">
        <div class="trow"><label>Subtotal</label><span class="v"><span class="cur" id="cur1">PKR</span> <span id="subtotal">0.00</span></span></div>
        <div class="trow"><label>Discount (%)</label><span class="v"><input type="number" id="discount" value="0" min="0" max="100" oninput="calcTotals()"> %</span></div>
        <div class="trow"><label>GST / Tax (%)</label><span class="v"><input type="number" id="tax" value="18" min="0" oninput="calcTotals()"> %</span></div>
        <div class="trow"><label>After Tax</label><span class="v"><span class="cur" id="cur2">PKR</span> <span id="after-tax">0.00</span></span></div>
        <div class="trow grand"><label>Grand Total</label><span class="v"><span class="cur" id="cur3">PKR</span> <span id="grand-total">0.00</span></span></div>
      </div>
    </div>

    <div class="nt-grid">
      <div class="nb">
        <h4>Notes</h4>
        <textarea id="doc-notes">All castings subject to standard inspection per agreed Sizes.
Pattern / tooling cost billed separately if applicable.</textarea>
      </div>
      <div class="nb">
        <h4>Terms &amp; Conditions</h4>
        <textarea id="doc-terms">Payment: 50% advance, 50% against delivery.
Validity: Prices valid for 30 days from issue date.</textarea>
      </div>
    </div>

    <div class="sig-row">
      <div class="sb"><label id="sig1-label">Authorized Signatory</label><div class="sl"></div><p>Name &amp; Designation / Stamp</p></div>
      <div class="sb"><label id="sig2-label">Client Acceptance</label><div class="sl"></div><p>Name &amp; Designation / Company Stamp</p></div>
    </div>

  </div>

  <div class="doc-foot">
    <div id="disp-foot-name">ABBAS &amp; SONS ROLL TECH</div>
    <div id="disp-foot-contact">03009429705</div>
  </div>
  <div class="doc-botbar"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>

/* ‚îÄ‚îÄ Dates ‚îÄ‚îÄ */
const today = new Date();
const fmtD  = d => d.toISOString().split('T')[0];
document.getElementById('meta-date').value = fmtD(today);
const vd = new Date(today); vd.setDate(vd.getDate()+30);
document.getElementById('meta-valid').value = fmtD(vd);

/* ‚îÄ‚îÄ Toggle settings panel ‚îÄ‚îÄ */
function toggleSettings(){
  const b=document.getElementById('sbody'), a=document.getElementById('sarr');
  const h=b.classList.toggle('hide');
  a.classList.toggle('closed',h); a.textContent=h?'‚ñº':'‚ñ≤';
}

/* ‚îÄ‚îÄ Sync settings ‚Üí doc ‚îÄ‚îÄ */
function sync(key){
  const v=document.getElementById('s-'+key).value;
  if(key==='company'){
    document.getElementById('disp-company').textContent=v;
    document.getElementById('disp-foot-name').textContent=v.toUpperCase();
  }
  if(key==='tagline') document.getElementById('disp-tagline').textContent=v;
  if(key==='addr')    document.getElementById('disp-addr').innerHTML=v.replace(/\n/g,'<br>');
  if(key==='foot-name')    document.getElementById('disp-foot-name').textContent=v.toUpperCase();
  if(key==='foot-contact') document.getElementById('disp-foot-contact').textContent=v;
}
function syncTA(key){ document.getElementById('doc-'+key).value=document.getElementById('s-'+key).value; }

/* ‚îÄ‚îÄ Logo ‚îÄ‚îÄ */
function uploadLogo(e){
  const f=e.target.files[0]; if(!f) return;
  const r=new FileReader();
  r.onload=ev=>{
    const i=document.getElementById('logo-display');
    i.src=ev.target.result; i.style.display='block';
    document.getElementById('logo-ph').style.display='none';
  }; r.readAsDataURL(f);
}
function removeLogo(){
  const i=document.getElementById('logo-display');
  i.src=''; i.style.display='none';
  document.getElementById('logo-ph').style.display='flex';
  document.getElementById('logo-input').value='';
}

/* ‚îÄ‚îÄ Currency ‚îÄ‚îÄ */
function updateCurrency(){
  const c=document.getElementById('s-currency').value||'PKR';
  ['cur1','cur2','cur3'].forEach(id=>document.getElementById(id).textContent=c);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   COLUMN VISIBILITY & WIDTHS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

// Map col key ‚Üí which th IDs and td class to show/hide
const COL_MAP = {
  dia:    { ths:['th-dia'],    tdClass:'td-dia',    span:'th-size-grp', spanContrib:1 },
  len:    { ths:['th-len'],    tdClass:'td-len',    span:'th-size-grp', spanContrib:1 },
  bore:   { ths:['th-bore'],   tdClass:'td-bore',   span:'th-size-grp', spanContrib:1 },
  weight: { ths:['th-weight'], tdClass:'td-weight' },
  qty:    { ths:['th-qty'],    tdClass:'td-qty' },
  unit:   { ths:['th-unit'],   tdClass:'td-unit' },
  rate:   { ths:['th-rate'],   tdClass:'td-rate' },
  amount: { ths:['th-amount'], tdClass:'td-amount' },
};

// Track visibility state
const colVis = { dia:true, len:true, bore:true, weight:true, qty:true, unit:false, rate:true, amount:true };

function toggleCol(key){
  colVis[key] = document.getElementById('col-'+key).checked;
  applyColVisibility();
}

function applyColVisibility(){
  // Size sub-headers
  ['dia','len','bore'].forEach(k=>{
    const th = document.getElementById('th-'+k);
    if(th) th.style.display = colVis[k] ? '' : 'none';
  });
  // Size group span count
  const sizeSpan = ['dia','len','bore'].filter(k=>colVis[k]).length;
  const sizeGrp = document.getElementById('th-size-grp');
  if(sizeGrp){
    sizeGrp.colSpan = Math.max(1, sizeSpan);
    sizeGrp.style.display = sizeSpan===0 ? 'none' : '';
  }
  // Other headers
  ['weight','qty','unit','rate','amount'].forEach(k=>{
    const th = document.getElementById('th-'+k);
    if(th) th.style.display = colVis[k] ? '' : 'none';
  });
  // Body cells
  document.querySelectorAll('#items-body tr').forEach(tr=>{
    Object.keys(colVis).forEach(k=>{
      tr.querySelectorAll('.td-'+k).forEach(td=>{
        td.style.display = colVis[k] ? '' : 'none';
      });
    });
  });
}

function applyWidths(){
  const keys=['desc','dia','len','bore','weight','qty','unit','rate','amount'];
  const thMap={desc:'th-desc',dia:'th-dia',len:'th-len',bore:'th-bore',weight:'th-weight',qty:'th-qty',unit:'th-unit',rate:'th-rate',amount:'th-amount'};
  keys.forEach(k=>{
    const inp=document.getElementById('w-'+k); if(!inp) return;
    const v=inp.value.trim();
    const th=document.getElementById(thMap[k]); if(!th) return;
    const px = (v===''||v==='auto') ? '' : (isNaN(v)?v:v+'px');
    th.style.width=px;
    // apply to all body tds
    document.querySelectorAll('#items-body .td-'+k).forEach(td=>td.style.width=px);
    if(k==='desc'){
      document.querySelectorAll('#items-body .td-desc').forEach(td=>td.style.width=px);
    }
  });
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SIZE CELL BUILDER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function makeSizeCell(fieldName){
  const wrap=document.createElement('div');
  wrap.className='size-td';
  const inp=document.createElement('input');
  inp.type='text'; inp.placeholder='‚Äî';
  let unit='in';
  const lbl=document.createElement('span');
  lbl.className='unit-label'; lbl.textContent='in';
  const tog=document.createElement('div');
  tog.className='unit-toggle';
  const bIn=document.createElement('button'); bIn.textContent='in'; bIn.type='button'; bIn.className='active'; bIn.title='Inches';
  const bMm=document.createElement('button'); bMm.textContent='mm'; bMm.type='button'; bMm.title='Millimetres';
  function setUnit(u){ unit=u; lbl.textContent=u; bIn.classList.toggle('active',u==='in'); bMm.classList.toggle('active',u==='mm'); }
  bIn.onclick=()=>setUnit('in'); bMm.onclick=()=>setUnit('mm');
  tog.appendChild(bIn); tog.appendChild(bMm);
  wrap.appendChild(inp); wrap.appendChild(tog); wrap.appendChild(lbl);
  return wrap;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ADD / DELETE ROWS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let rc=0;
function addRow(){
  rc++;
  const n=rc;
  const tr=document.createElement('tr');
  tr.id='r'+n;

  function mkTd(cls,extra){
    const td=document.createElement('td');
    td.className=cls;
    if(extra) extra(td);
    td.style.display=colVis[cls.replace('td-','')]===false?'none':'';
    return td;
  }

  // # serial
  const tdN=document.createElement('td');
  tdN.style.cssText='color:#aaa;text-align:center;font-size:.7rem;width:28px';
  tdN.textContent=n;

  // description
  const tdD=document.createElement('td');
  tdD.className='td-desc';
  const inpD=document.createElement('input'); inpD.type='text'; inpD.placeholder='e.g. Centrifugal Roll ‚Äì SG Iron';
  inpD.style.width='100%'; tdD.appendChild(inpD);

  // size cells
  const tdDia  = mkTd('td-dia',  td=>{ td.appendChild(makeSizeCell('Dia')); });
  const tdLen  = mkTd('td-len',  td=>{ td.appendChild(makeSizeCell('Length')); });
  const tdBore = mkTd('td-bore', td=>{ td.appendChild(makeSizeCell('Bore')); });

  // weight
  const tdW=mkTd('td-weight',td=>{
    const i=document.createElement('input'); i.type='number'; i.className='weight'; i.value='0'; i.min='0'; i.step='0.001'; i.oninput=calcTotals; i.style.width='100%'; td.appendChild(i);
  });

  // qty
  const tdQ=mkTd('td-qty',td=>{
    const i=document.createElement('input'); i.type='number'; i.className='qty'; i.value='1'; i.min='0'; i.oninput=calcTotals; i.style.width='100%'; td.appendChild(i);
  });

  // unit
  const tdU=mkTd('td-unit',td=>{
    const s=document.createElement('select'); s.style.cssText='width:100%;border:none;background:transparent;font-family:Barlow,sans-serif;font-size:.76rem;color:var(--iron);outline:none';
    ['Pcs','Kg','MT','Set','Lot'].forEach(u=>{const o=document.createElement('option');o.textContent=u;s.appendChild(o);}); td.appendChild(s);
    td.style.display=colVis['unit']?'':'none';
  });

  // rate
  const tdR=mkTd('td-rate',td=>{
    const i=document.createElement('input'); i.type='number'; i.className='rate'; i.value='0'; i.min='0'; i.step='0.01'; i.oninput=calcTotals; i.style.width='100%'; td.appendChild(i);
  });

  // amount
  const tdA=mkTd('td-amount',td=>{ td.className='tc td-amount'; td.textContent='0.00'; });

  // delete
  const tdX=document.createElement('td');
  const btnX=document.createElement('button'); btnX.className='del-btn'; btnX.textContent='‚úï'; btnX.onclick=()=>delRow(n); tdX.appendChild(btnX);

  [tdN,tdD,tdDia,tdLen,tdBore,tdW,tdQ,tdU,tdR,tdA,tdX].forEach(td=>tr.appendChild(td));
  document.getElementById('items-body').appendChild(tr);
  applyColVisibility();
  applyWidths();
  calcTotals();
}

function delRow(n){ const el=document.getElementById('r'+n); if(el) el.remove(); calcTotals(); }

/* ‚îÄ‚îÄ Calc ‚îÄ‚îÄ */
function fmt(n){ return n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}); }
function calcTotals(){
  let sub=0;
  document.querySelectorAll('#items-body tr').forEach(tr=>{
    const w=parseFloat(tr.querySelector('.weight')?.value||0);
    const q=parseFloat(tr.querySelector('.qty')?.value||0);
    const r=parseFloat(tr.querySelector('.rate')?.value||0);
    const amt=w*q*r;
    const tc=tr.querySelector('.tc'); if(tc) tc.textContent=fmt(amt);
    sub+=amt;
  });
  const disc=parseFloat(document.getElementById('discount').value||0);
  const tax =parseFloat(document.getElementById('tax').value||0);
  const aD=sub*(1-disc/100);
  const aT=aD*(1+tax/100);
  document.getElementById('subtotal').textContent=fmt(sub);
  document.getElementById('after-tax').textContent=fmt(aT);
  document.getElementById('grand-total').textContent=fmt(aT);
}

/* ‚îÄ‚îÄ Reset ‚îÄ‚îÄ */
function resetForm(){
  if(!confirm('Clear all items and reset the form?')) return;
  document.getElementById('items-body').innerHTML='';
  rc=0; document.getElementById('customer-name').value='';
  addRow(); addRow(); addRow();
}

/* ‚îÄ‚îÄ Init ‚îÄ‚îÄ */
// Apply initial column visibility (Unit hidden by default)
document.getElementById('col-unit').checked = false;
addRow(); addRow(); addRow();
applyColVisibility();
applyWidths();

/* ‚îÄ‚îÄ PDF ‚îÄ‚îÄ */
async function downloadPDF(){
  const panel=document.getElementById('settings-panel');
  const addBtn=document.querySelector('.add-btn');
  const delBtns=document.querySelectorAll('.del-btn');
  const togs=document.querySelectorAll('.unit-toggle');
  const lbls=document.querySelectorAll('.unit-label');
  panel.style.display='none'; addBtn.style.display='none';
  delBtns.forEach(b=>b.style.display='none');
  togs.forEach(t=>t.style.display='none');
  lbls.forEach(l=>l.style.display='inline');
  try{
    const el=document.getElementById('quote-doc');
    const canvas=await html2canvas(el,{scale:2,useCORS:true,backgroundColor:'#f5f2ee'});
    const img=canvas.toDataURL('image/png');
    const {jsPDF}=window.jspdf;
    const pdf=new jsPDF({orientation:'portrait',unit:'mm',format:'a4'});
    const pw=pdf.internal.pageSize.getWidth(), ph=pdf.internal.pageSize.getHeight();
    const ih=canvas.height*pw/canvas.width;
    if(ih<=ph){ pdf.addImage(img,'PNG',0,0,pw,ih); }
    else { let y=0; while(y<ih){ pdf.addImage(img,'PNG',0,-y,pw,ih); y+=ph; if(y<ih) pdf.addPage(); } }
    const co=(document.getElementById('s-company').value||'Quote').replace(/\s+/g,'_');
    const ref=document.getElementById('quote-ref').value||'QT';
    pdf.save(`${co}_${ref}.pdf`);
  } finally {
    panel.style.display=''; addBtn.style.display='';
    delBtns.forEach(b=>b.style.display='');
    togs.forEach(t=>t.style.display='');
    lbls.forEach(l=>l.style.display='none');
  }
}
</script>
</body>
</html>
