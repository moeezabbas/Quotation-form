<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quotation â€“ Iron Casting & Manufacturing</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Barlow:wght@300;400;500;600&family=Barlow+Condensed:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --iron:#1a1a1a; --rust:#b84a1e; --steel:#3d5a6e;
  --silver:#c0c8d0; --warm:#f5f2ee; --amber:#d4802a; --lgray:#e8e4df;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Barlow',sans-serif;background:#ccc8c0;color:var(--iron);min-height:100vh;padding:16px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETTINGS PANEL  (no-print)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#settings-panel{max-width:1020px;margin:0 auto 18px;border-radius:5px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.45);}

.s-topbar{
  background:#000;padding:12px 20px;display:flex;align-items:center;
  justify-content:space-between;cursor:pointer;user-select:none;
}
.s-topbar h2{font-family:'Bebas Neue',sans-serif;letter-spacing:4px;font-size:1rem;color:var(--amber);}
.s-topbar .badge{
  background:#222;border:1px solid #444;border-radius:3px;
  padding:3px 10px;font-size:.65rem;letter-spacing:2px;color:#888;text-transform:uppercase;
}
.s-topbar .arr{color:var(--amber);font-size:.9rem;transition:transform .3s;}
.s-topbar .arr.closed{transform:rotate(180deg);}

.s-body{
  background:#111;padding:20px 22px 24px;
  display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px;
}
.s-body.hide{display:none;}

.sg{background:#1c1c1c;border:1px solid #2e2e2e;border-radius:3px;padding:13px;}
.sg-title{
  font-family:'Barlow Condensed',sans-serif;font-size:.65rem;letter-spacing:3px;
  text-transform:uppercase;color:var(--amber);margin-bottom:10px;
  border-bottom:1px solid #2e2e2e;padding-bottom:5px;
}
.sf{display:flex;flex-direction:column;gap:3px;margin-bottom:9px;}
.sf:last-child{margin-bottom:0;}
.sf label{font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:var(--silver);}
.sf input,.sf textarea,.sf select{
  background:#242424;border:1px solid #383838;border-radius:2px;
  color:#ddd;font-family:'Barlow',sans-serif;font-size:.82rem;
  padding:6px 9px;outline:none;width:100%;
}
.sf textarea{resize:vertical;min-height:68px;line-height:1.5;}
.sf input:focus,.sf textarea:focus{border-color:var(--rust);}

.logo-btn{
  background:var(--rust);color:#fff;border:none;padding:7px 0;
  font-family:'Barlow Condensed',sans-serif;font-size:.78rem;letter-spacing:2px;
  text-transform:uppercase;cursor:pointer;border-radius:2px;width:100%;margin-top:5px;
}
.logo-btn:hover{background:#9e3614;}

.s-wide{grid-column:1/-1;}
.action-bar{grid-column:1/-1;display:flex;gap:10px;flex-wrap:wrap;padding-top:4px;}
.btn{
  padding:10px 22px;font-family:'Barlow Condensed',sans-serif;
  font-size:.88rem;letter-spacing:2px;text-transform:uppercase;
  border:none;cursor:pointer;border-radius:2px;font-weight:600;
}
.btn-pdf{background:var(--rust);color:#fff;}
.btn-pdf:hover{background:#9e3614;}
.btn-print{background:var(--steel);color:#fff;}
.btn-print:hover{background:#2c3f50;}
.btn-reset{background:#2a2a2a;color:#888;}
.btn-reset:hover{background:#333;color:#aaa;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUOTE DOCUMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#quote-doc{background:var(--warm);max-width:1020px;margin:0 auto;box-shadow:0 6px 36px rgba(0,0,0,.28);overflow:hidden;}

.doc-topbar{background:var(--iron);height:7px;}

/* header */
.doc-header{
  display:grid;grid-template-columns:auto 1fr auto;
  align-items:center;gap:20px;padding:26px 34px 20px;
  border-bottom:3px solid var(--rust);position:relative;
}
.doc-header::after{content:'';position:absolute;bottom:-6px;left:0;right:0;height:1px;background:var(--amber);}

#logo-display{width:82px;height:82px;object-fit:contain;display:none;}
#logo-ph{width:82px;height:82px;background:var(--iron);display:flex;align-items:center;justify-content:center;}
#logo-ph svg{opacity:.4;}

#disp-company{font-family:'Bebas Neue',sans-serif;font-size:2.1rem;letter-spacing:4px;line-height:1;}
#disp-tagline{font-family:'Barlow Condensed',sans-serif;font-size:.8rem;letter-spacing:3px;text-transform:uppercase;color:var(--rust);margin-top:3px;}
#disp-addr{font-size:.74rem;color:#666;margin-top:7px;line-height:1.65;}

.qtitle-block{text-align:right;}
.qtitle-block h1{font-family:'Bebas Neue',sans-serif;font-size:2.7rem;letter-spacing:6px;color:var(--steel);line-height:1;}
.qref-label{font-size:.65rem;letter-spacing:2px;text-transform:uppercase;color:#999;margin-top:5px;}
.qref-input{
  text-align:right;border:none;border-bottom:2px solid var(--rust);
  font-family:'Barlow Condensed',sans-serif;font-size:1.1rem;font-weight:700;
  color:var(--rust);outline:none;background:transparent;width:155px;
}

/* meta strip */
.doc-meta{background:var(--steel);display:grid;grid-template-columns:repeat(4,1fr);}
.mc{padding:10px 18px;border-right:1px solid rgba(255,255,255,.12);}
.mc:last-child{border-right:none;}
.mc label{display:block;font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:var(--silver);margin-bottom:3px;}
.mc input{
  background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.25);
  color:#fff;font-family:'Barlow',sans-serif;font-size:.86rem;width:100%;outline:none;padding:2px 0;
}
.mc input::placeholder{color:rgba(255,255,255,.28);}

/* body */
.doc-body{padding:26px 34px;}

/* customer row */
.customer-row{
  display:grid;grid-template-columns:1fr auto;align-items:end;gap:20px;
  background:#ede9e3;border-left:4px solid var(--rust);padding:13px 16px;margin-bottom:22px;
}
.cr-left label,.cr-right label{
  display:block;font-family:'Bebas Neue',sans-serif;font-size:.78rem;
  letter-spacing:3px;color:var(--rust);margin-bottom:5px;
}
.cr-right label{color:var(--steel);}
.cr-left input,.cr-right input{
  background:transparent;border:none;border-bottom:1px solid #bbb;
  font-family:'Barlow',sans-serif;font-size:.95rem;color:var(--iron);
  outline:none;padding:3px 0;
}
.cr-left input{width:100%;}
.cr-right input{width:150px;text-align:right;font-family:'Barlow Condensed',sans-serif;font-weight:700;color:var(--rust);font-size:1.05rem;border-bottom-color:var(--rust);}

/* section title */
.stitle{
  font-family:'Bebas Neue',sans-serif;font-size:.95rem;letter-spacing:4px;
  color:var(--iron);border-bottom:2px solid var(--rust);
  padding-bottom:5px;margin-bottom:12px;display:flex;align-items:center;gap:10px;
}
.stitle .line{flex:1;height:1px;background:var(--lgray);}

/* â”€â”€â”€ Items table â”€â”€â”€ */
.tbl-wrap{overflow-x:auto;}
table.itable{width:100%;border-collapse:collapse;font-size:.77rem;min-width:780px;}
table.itable thead tr.th-main{background:var(--iron);color:var(--warm);}
table.itable thead tr.th-sub{background:#2d4555;color:var(--silver);}
table.itable th{
  padding:8px 7px;text-align:left;
  font-family:'Barlow Condensed',sans-serif;font-size:.67rem;
  letter-spacing:1.5px;text-transform:uppercase;font-weight:600;
}
table.itable th.ctr{text-align:center;}
table.itable th.rgt{text-align:right;}
table.itable .size-span{text-align:center;letter-spacing:2px;color:var(--silver);font-size:.65rem;}

table.itable tbody tr{border-bottom:1px solid var(--lgray);}
table.itable tbody tr:nth-child(even){background:rgba(0,0,0,.018);}
table.itable tbody tr:hover{background:#ede9e3;}
table.itable td{padding:5px 7px;vertical-align:middle;}
table.itable td input,table.itable td select{
  width:100%;border:none;background:transparent;
  font-family:'Barlow',sans-serif;font-size:.77rem;color:var(--iron);
  outline:none;padding:2px 0;
}
table.itable td input[type="number"]{text-align:right;}
table.itable td input.ctr-inp{text-align:center;}
table.itable .tc{text-align:right;font-weight:600;color:var(--rust);font-family:'Barlow Condensed',sans-serif;font-size:.86rem;}
.del-btn{background:none;border:none;cursor:pointer;color:#ccc;font-size:.85rem;padding:0 2px;}
.del-btn:hover{color:var(--rust);}

.add-btn{
  margin-top:9px;background:none;border:2px dashed var(--steel);color:var(--steel);
  font-family:'Barlow Condensed',sans-serif;font-size:.75rem;letter-spacing:2px;
  text-transform:uppercase;padding:7px 16px;cursor:pointer;border-radius:2px;transition:all .2s;
}
.add-btn:hover{background:var(--steel);color:#fff;}

/* totals */
.totals-wrap{display:flex;justify-content:flex-end;margin-top:18px;}
.tbox{background:#ede9e3;border:1px solid var(--lgray);min-width:300px;}
.trow{display:flex;justify-content:space-between;align-items:center;padding:8px 15px;border-bottom:1px solid var(--lgray);font-size:.82rem;}
.trow label{color:#666;}
.trow .v{font-weight:600;font-family:'Barlow Condensed',sans-serif;}
.trow input[type="number"]{
  border:none;background:transparent;font-family:'Barlow',sans-serif;
  font-size:.82rem;font-weight:600;width:52px;text-align:right;outline:none;color:var(--iron);
}
.trow.grand{background:var(--iron);color:#fff;padding:11px 15px;}
.trow.grand label{color:var(--silver);letter-spacing:2px;font-family:'Barlow Condensed',sans-serif;text-transform:uppercase;font-size:.68rem;}
.trow.grand .v{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;color:var(--amber);letter-spacing:2px;}
.cur{margin-right:2px;color:#999;font-size:.78rem;}
.trow.grand .cur{color:#aaa;}

/* notes & terms */
.nt-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:22px;}
.nb h4{font-family:'Bebas Neue',sans-serif;letter-spacing:3px;font-size:.8rem;color:var(--steel);margin-bottom:6px;}
.nb textarea{
  width:100%;background:#ede9e3;
  border:1px solid var(--lgray);border-left:3px solid var(--steel);
  font-family:'Barlow',sans-serif;font-size:.78rem;color:var(--iron);
  padding:9px 11px;resize:vertical;outline:none;min-height:80px;line-height:1.6;
}

/* signature */
.sig-row{display:grid;grid-template-columns:1fr 1fr;gap:34px;margin-top:26px;padding-top:18px;border-top:1px solid var(--lgray);}
.sb label{display:block;font-size:.62rem;letter-spacing:2px;text-transform:uppercase;color:#aaa;margin-bottom:7px;}
.sl{border-bottom:1px solid var(--iron);height:36px;margin-bottom:4px;}
.sb p{font-size:.7rem;color:#bbb;letter-spacing:.5px;}

/* footer */
.doc-foot{background:var(--iron);padding:13px 34px;display:flex;justify-content:space-between;align-items:center;}
#disp-foot-name{font-family:'Bebas Neue',sans-serif;letter-spacing:3px;color:var(--silver);font-size:.85rem;}
#disp-foot-contact{font-size:.68rem;color:#666;text-align:right;}
.doc-botbar{background:var(--rust);height:5px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PRINT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media print{
  body{background:#fff;padding:0;}
  #settings-panel{display:none!important;}
  #quote-doc{box-shadow:none;max-width:100%;}
  .add-btn,.del-btn{display:none!important;}
  input,select,textarea{border-color:transparent!important;background:transparent!important;}
  .mc input{border-bottom:1px solid rgba(255,255,255,.25)!important;}
  .nb textarea{border:none!important;padding:0!important;}
  @page{margin:0;size:A4;}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     âš™  SETTINGS PANEL  â€” hidden in PDF
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="settings-panel">

  <div class="s-topbar" onclick="toggleSettings()">
    <h2>âš™ Settings &amp; Customization</h2>
    <span class="badge">ğŸ”’ Hidden in PDF / Print</span>
    <span class="arr" id="sarr">â–²</span>
  </div>

  <div class="s-body" id="sbody">

    <!-- Logo -->
    <div class="sg">
      <div class="sg-title">Company Logo</div>
      <div class="sf">
        <label>Upload Logo Image</label>
        <button class="logo-btn" onclick="document.getElementById('logo-input').click()">ğŸ“ Upload Logo</button>
        <input type="file" id="logo-input" accept="image/*" style="display:none" onchange="uploadLogo(event)">
      </div>
      <div class="sf">
        <label>Remove Logo</label>
        <button class="logo-btn" style="background:#333" onclick="removeLogo()">âœ• Remove Logo</button>
      </div>
    </div>

    <!-- Company Info -->
    <div class="sg">
      <div class="sg-title">Company Info</div>
      <div class="sf"><label>Company Name</label><input id="s-company" value="FERRUM CAST INDUSTRIES" oninput="sync('company')"></div>
      <div class="sf"><label>Tagline / Division</label><input id="s-tagline" value="Iron Casting & Precision Manufacturing" oninput="sync('tagline')"></div>
    </div>

    <!-- Address -->
    <div class="sg">
      <div class="sg-title">Address &amp; Contact</div>
      <div class="sf">
        <label>Address (Header)</label>
        <textarea id="s-addr" oninput="sync('addr')">Plot 42, Industrial Area Phase II
Lahore, Punjab 54000 Â· Pakistan
Tel: +92 42 3456 7890
info@ferrumcast.com</textarea>
      </div>
    </div>

    <!-- Footer -->
    <div class="sg">
      <div class="sg-title">Footer Line</div>
      <div class="sf"><label>Footer Company Name</label><input id="s-foot-name" value="FERRUM CAST INDUSTRIES" oninput="sync('foot-name')"></div>
      <div class="sf"><label>Footer Contact</label><input id="s-foot-contact" value="ferrumcast.com Â· info@ferrumcast.com Â· +92-42-3456-7890" oninput="sync('foot-contact')"></div>
    </div>

    <!-- Currency & Tax defaults -->
    <div class="sg">
      <div class="sg-title">Currency &amp; Tax</div>
      <div class="sf"><label>Currency Symbol</label><input id="s-currency" value="PKR" oninput="updateCurrency()"></div>
      <div class="sf"><label>Default GST/Tax %</label><input type="number" id="s-default-tax" value="18" min="0" oninput="document.getElementById('tax').value=this.value;calcTotals()"></div>
      <div class="sf"><label>Default Discount %</label><input type="number" id="s-default-disc" value="0" min="0" oninput="document.getElementById('discount').value=this.value;calcTotals()"></div>
    </div>

    <!-- Notes & Terms -->
    <div class="sg s-wide">
      <div class="sg-title">Default Notes &amp; Terms (editable in document too)</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
        <div class="sf">
          <label>Notes</label>
          <textarea id="s-notes" oninput="syncTextarea('notes')">Prices quoted are Ex-Works (EXW) our factory.
All castings subject to standard inspection per agreed drawing.
Pattern / tooling cost billed separately if applicable.</textarea>
        </div>
        <div class="sf">
          <label>Terms &amp; Conditions</label>
          <textarea id="s-terms" oninput="syncTextarea('terms')">Payment: 50% advance, 50% against delivery.
Validity: Prices valid for 30 days from issue date.
Warranty: Defective castings replaced FOC within 30 days.
Force majeure and raw material price escalation clauses apply.</textarea>
        </div>
      </div>
    </div>

    <!-- Signature labels -->
    <div class="sg">
      <div class="sg-title">Signature Labels</div>
      <div class="sf"><label>Signatory 1 Label</label><input id="s-sig1" value="Authorized Signatory" oninput="document.getElementById('sig1-label').textContent=this.value"></div>
      <div class="sf"><label>Signatory 2 Label</label><input id="s-sig2" value="Client Acceptance" oninput="document.getElementById('sig2-label').textContent=this.value"></div>
    </div>

    <!-- Actions -->
    <div class="action-bar">
      <button class="btn btn-pdf" onclick="downloadPDF()">â¬‡ Download PDF</button>
      <button class="btn btn-print" onclick="window.print()">ğŸ–¨ Print / Save as PDF</button>
      <button class="btn btn-reset" onclick="resetForm()">â†º Reset Form</button>
    </div>

  </div><!-- /s-body -->
</div><!-- /settings-panel -->


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     QUOTATION DOCUMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="quote-doc">
  <div class="doc-topbar"></div>

  <!-- Header -->
  <div class="doc-header">
    <div>
      <img id="logo-display" src="" alt="Logo">
      <div id="logo-ph">
        <svg width="58" height="58" viewBox="0 0 60 60" fill="none">
          <polygon points="30,4 56,18 56,42 30,56 4,42 4,18" stroke="#c0c8d0" stroke-width="2" fill="none"/>
          <polygon points="30,14 46,23 46,37 30,46 14,37 14,23" stroke="#b84a1e" stroke-width="1.5" fill="none"/>
          <circle cx="30" cy="30" r="5.5" fill="#c0c8d0"/>
        </svg>
      </div>
    </div>

    <div>
      <div id="disp-company">FERRUM CAST INDUSTRIES</div>
      <div id="disp-tagline">Iron Casting &amp; Precision Manufacturing</div>
      <div id="disp-addr">Plot 42, Industrial Area Phase II<br>Lahore, Punjab 54000 Â· Pakistan<br>Tel: +92 42 3456 7890 Â· info@ferrumcast.com</div>
    </div>

    <div class="qtitle-block">
      <h1>QUOTATION</h1>
      <div class="qref-label">Quote Reference</div>
      <input class="qref-input" type="text" id="quote-ref" value="FCI-2026-001">
    </div>
  </div>

  <!-- Meta strip: date / valid / lead / customer -->
  <div class="doc-meta">
    <div class="mc"><label>Issue Date</label><input type="date" id="meta-date"></div>
    <div class="mc"><label>Valid Until</label><input type="date" id="meta-valid"></div>
    <div class="mc"><label>Delivery Lead Time</label><input type="text" placeholder="e.g. 4â€“6 weeks after PO"></div>
    <div class="mc"><label>Payment Terms</label><input type="text" placeholder="50% Advance / 50% Delivery"></div>
  </div>

  <!-- Body -->
  <div class="doc-body">

    <!-- Customer + Quote # row -->
    <div class="customer-row">
      <div class="cr-left">
        <label>Customer / Party Name</label>
        <input type="text" id="customer-name" placeholder="Enter customer or party nameâ€¦">
      </div>
      <div class="cr-right">
        <label>Quote No.</label>
        <input type="text" value="FCI-2026-001" oninput="document.getElementById('quote-ref').value=this.value">
      </div>
    </div>

    <!-- Items -->
    <div class="stitle">Items &amp; Specifications <span class="line"></span></div>
    <div class="tbl-wrap">
      <table class="itable" id="itable">
        <thead>
          <tr class="th-main">
            <th style="width:32px">#</th>
            <th style="min-width:140px">Item / Description</th>
            <!-- Size group spanning 3 sub-cols -->
            <th class="ctr" colspan="3" style="width:180px">Size</th>
            <th class="rgt" style="width:70px">Weight<br><span style="font-size:.6rem;opacity:.6">(kg)</span></th>
            <th class="rgt" style="width:75px">Qty</th>
            <th style="width:60px">Unit</th>
            <th class="rgt" style="width:90px">Rate / kg</th>
            <th class="rgt" style="width:95px">Amount</th>
            <th style="width:26px"></th>
          </tr>
          <tr class="th-sub">
            <th></th>
            <th></th>
            <th class="ctr" style="width:60px">Dia (mm)</th>
            <th class="ctr" style="width:60px">Length (mm)</th>
            <th class="ctr" style="width:60px">Bore (mm)</th>
            <th></th><th></th><th></th><th></th><th></th><th></th>
          </tr>
        </thead>
        <tbody id="items-body"></tbody>
      </table>
    </div>
    <button class="add-btn" onclick="addRow()">+ Add Item</button>

    <!-- Totals -->
    <div class="totals-wrap">
      <div class="tbox">
        <div class="trow">
          <label>Subtotal</label>
          <span class="v"><span class="cur" id="cur1">PKR</span> <span id="subtotal">0.00</span></span>
        </div>
        <div class="trow">
          <label>Discount (%)</label>
          <span class="v"><input type="number" id="discount" value="0" min="0" max="100" oninput="calcTotals()"> %</span>
        </div>
        <div class="trow">
          <label>GST / Tax (%)</label>
          <span class="v"><input type="number" id="tax" value="18" min="0" oninput="calcTotals()"> %</span>
        </div>
        <div class="trow">
          <label>After Tax Subtotal</label>
          <span class="v"><span class="cur" id="cur2">PKR</span> <span id="after-tax">0.00</span></span>
        </div>
        <div class="trow grand">
          <label>Grand Total</label>
          <span class="v"><span class="cur" id="cur3">PKR</span> <span id="grand-total">0.00</span></span>
        </div>
      </div>
    </div>

    <!-- Notes & Terms -->
    <div class="nt-grid">
      <div class="nb">
        <h4>Notes</h4>
        <textarea id="doc-notes">Prices quoted are Ex-Works (EXW) our factory.
All castings subject to standard inspection per agreed drawing.
Pattern / tooling cost billed separately if applicable.</textarea>
      </div>
      <div class="nb">
        <h4>Terms &amp; Conditions</h4>
        <textarea id="doc-terms">Payment: 50% advance, 50% against delivery.
Validity: Prices valid for 30 days from issue date.
Warranty: Defective castings replaced FOC within 30 days.
Force majeure and raw material price escalation clauses apply.</textarea>
      </div>
    </div>

    <!-- Signatures -->
    <div class="sig-row">
      <div class="sb">
        <label id="sig1-label">Authorized Signatory</label>
        <div class="sl"></div>
        <p>Name &amp; Designation / Stamp</p>
      </div>
      <div class="sb">
        <label id="sig2-label">Client Acceptance</label>
        <div class="sl"></div>
        <p>Name &amp; Designation / Company Stamp</p>
      </div>
    </div>

  </div><!-- /doc-body -->

  <div class="doc-foot">
    <div id="disp-foot-name">FERRUM CAST INDUSTRIES</div>
    <div id="disp-foot-contact">ferrumcast.com Â· info@ferrumcast.com Â· +92-42-3456-7890</div>
  </div>
  <div class="doc-botbar"></div>
</div><!-- /quote-doc -->

<!-- jsPDF + html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
/* â”€â”€â”€ Dates â”€â”€â”€ */
const today = new Date();
const fmtDate = d => d.toISOString().split('T')[0];
document.getElementById('meta-date').value = fmtDate(today);
const vd = new Date(today); vd.setDate(vd.getDate()+30);
document.getElementById('meta-valid').value = fmtDate(vd);

/* â”€â”€â”€ Toggle settings â”€â”€â”€ */
function toggleSettings(){
  const body = document.getElementById('sbody');
  const arr  = document.getElementById('sarr');
  const hidden = body.classList.toggle('hide');
  arr.classList.toggle('closed', hidden);
  arr.textContent = hidden ? 'â–¼' : 'â–²';
}

/* â”€â”€â”€ Sync settings â†’ document â”€â”€â”€ */
function sync(key){
  const val = document.getElementById('s-'+key).value;
  if(key==='company'){
    document.getElementById('disp-company').textContent = val;
    document.getElementById('disp-foot-name').textContent = val.toUpperCase();
  }
  if(key==='tagline') document.getElementById('disp-tagline').textContent = val;
  if(key==='addr')    document.getElementById('disp-addr').innerHTML = val.replace(/\n/g,'<br>');
  if(key==='foot-name')    document.getElementById('disp-foot-name').textContent = val;
  if(key==='foot-contact') document.getElementById('disp-foot-contact').textContent = val;
}

function syncTextarea(key){
  const val = document.getElementById('s-'+key).value;
  document.getElementById('doc-'+key).value = val;
}

/* â”€â”€â”€ Logo â”€â”€â”€ */
function uploadLogo(e){
  const file = e.target.files[0]; if(!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    const img = document.getElementById('logo-display');
    img.src = ev.target.result; img.style.display='block';
    document.getElementById('logo-ph').style.display='none';
  };
  reader.readAsDataURL(file);
}
function removeLogo(){
  const img = document.getElementById('logo-display');
  img.src=''; img.style.display='none';
  document.getElementById('logo-ph').style.display='flex';
  document.getElementById('logo-input').value='';
}

/* â”€â”€â”€ Currency â”€â”€â”€ */
function updateCurrency(){
  const c = document.getElementById('s-currency').value || 'PKR';
  ['cur1','cur2','cur3'].forEach(id => document.getElementById(id).textContent = c);
}

/* â”€â”€â”€ Rows â”€â”€â”€ */
let rc = 0;
function addRow(){
  rc++;
  const n = rc;
  const tbody = document.getElementById('items-body');
  const tr = document.createElement('tr');
  tr.id = 'r'+n;
  tr.innerHTML = `
    <td style="color:#aaa;text-align:center;font-size:.72rem">${n}</td>
    <td><input type="text" placeholder="e.g. Flywheel Housing â€“ Grey CI GR20"></td>
    <!-- Size: Dia, Length, Bore -->
    <td><input type="text" class="ctr-inp size-inp" placeholder="â€”"></td>
    <td><input type="text" class="ctr-inp size-inp" placeholder="â€”"></td>
    <td><input type="text" class="ctr-inp size-inp" placeholder="â€”"></td>
    <!-- Weight -->
    <td><input type="number" class="weight" value="0" min="0" step="0.001" oninput="calcTotals()"></td>
    <!-- Qty -->
    <td><input type="number" class="qty" value="1" min="0" oninput="calcTotals()"></td>
    <!-- Unit -->
    <td>
      <select style="width:100%;border:none;background:transparent;font-family:'Barlow',sans-serif;font-size:.77rem;color:var(--iron);outline:none">
        <option>Pcs</option><option>Kg</option><option>MT</option><option>Set</option><option>Lot</option>
      </select>
    </td>
    <!-- Rate per kg -->
    <td><input type="number" class="rate" value="0" min="0" step="0.01" oninput="calcTotals()"></td>
    <!-- Amount = weight Ã— qty Ã— rate -->
    <td class="tc" id="amt-${n}">0.00</td>
    <td><button class="del-btn" onclick="delRow(${n})">âœ•</button></td>
  `;
  tbody.appendChild(tr);
  calcTotals();
}

function delRow(n){
  const el = document.getElementById('r'+n);
  if(el) el.remove();
  calcTotals();
}

/* â”€â”€â”€ Calculations: Amount = Weight(kg) Ã— Qty Ã— Rate â”€â”€â”€ */
function calcTotals(){
  let sub = 0;
  document.querySelectorAll('#items-body tr').forEach(tr => {
    const w = parseFloat(tr.querySelector('.weight')?.value||0);
    const q = parseFloat(tr.querySelector('.qty')?.value||0);
    const r = parseFloat(tr.querySelector('.rate')?.value||0);
    const amt = w * q * r;
    const cell = tr.querySelector('.tc');
    if(cell) cell.textContent = fmt(amt);
    sub += amt;
  });
  const disc = parseFloat(document.getElementById('discount').value||0);
  const tax  = parseFloat(document.getElementById('tax').value||0);
  const afterDisc = sub * (1 - disc/100);
  const afterTax  = afterDisc * (1 + tax/100);
  document.getElementById('subtotal').textContent   = fmt(sub);
  document.getElementById('after-tax').textContent  = fmt(afterTax);
  document.getElementById('grand-total').textContent= fmt(afterTax);
}

function fmt(n){ return n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}); }

/* â”€â”€â”€ Reset â”€â”€â”€ */
function resetForm(){
  if(!confirm('Reset all items and clear the form?')) return;
  document.getElementById('items-body').innerHTML='';
  rc=0;
  document.getElementById('customer-name').value='';
  addRow(); addRow(); addRow();
}

/* â”€â”€â”€ Init rows â”€â”€â”€ */
addRow(); addRow(); addRow();

/* â”€â”€â”€ PDF â”€â”€â”€ */
async function downloadPDF(){
  const panel   = document.getElementById('settings-panel');
  const addBtn  = document.querySelector('.add-btn');
  const delBtns = document.querySelectorAll('.del-btn');
  panel.style.display = 'none';
  addBtn.style.display = 'none';
  delBtns.forEach(b=>b.style.display='none');

  try{
    const el = document.getElementById('quote-doc');
    const canvas = await html2canvas(el,{scale:2,useCORS:true,backgroundColor:'#f5f2ee'});
    const img = canvas.toDataURL('image/png');
    const {jsPDF} = window.jspdf;
    const pdf = new jsPDF({orientation:'portrait',unit:'mm',format:'a4'});
    const pw  = pdf.internal.pageSize.getWidth();
    const ph  = pdf.internal.pageSize.getHeight();
    const ih  = canvas.height * pw / canvas.width;

    if(ih <= ph){
      pdf.addImage(img,'PNG',0,0,pw,ih);
    } else {
      let y=0;
      while(y < ih){
        pdf.addImage(img,'PNG',0,-y,pw,ih);
        y += ph;
        if(y < ih) pdf.addPage();
      }
    }
    const co = (document.getElementById('s-company').value||'Quote').replace(/\s+/g,'_');
    const ref= document.getElementById('quote-ref').value||'QT';
    pdf.save(`${co}_${ref}.pdf`);
  } finally {
    panel.style.display='';
    addBtn.style.display='';
    delBtns.forEach(b=>b.style.display='');
  }
}
</script>
</body>
</html>
